# Error Handling Guide

This guide provides detailed explanations and best practices for handling common errors that may be encountered when using the `DMI.Load` method and related functionalities.

## Table of Contents

- [File Not Found](#file-not-found)
- [Error Loading Metadata](#error-loading-metadata)
- [General Error Occurred](#general-error-occurred)
- [Missing Version Header](#missing-version-header)
- [Incompatible DMI Version](#incompatible-dmi-version)
- [Missing Width or Height Information](#missing-width-or-height-information)
- [PNG Header Mismatch](#png-header-mismatch)
- [Unknown Compression Method](#unknown-compression-method)
- [zTXt Chunk Not Found](#ztxt-chunk-not-found)

---

## File Not Found

**Error Message:** "DMI.Load: The file cannot be found. Verify your path."

**Description:** This error occurs when the DMI file you are trying to load is not found at the specified path.

**Resolution:**

- Make sure that the file path provided is correct.
- Check the spelling and case-sensitivity of the file and directory names.
- Ensure that the file actually exists in the location specified by the path.

---

## Error Loading Metadata

**Error Message:** "DMI.Load: Error while loading metadata file information."

**Description:** This error is raised when there is a problem loading metadata from the DMI file.

**Resolution:**

- Ensure that the DMI file is not corrupted.
- Check if the file has the necessary metadata and it is in the correct format.
- Make sure the DMI file adheres to the expected structure.

---

## General Error Occurred

**Error Message:** "DMI.Load: An error occurred: (Message) Source: (Source) StackTrace: (StackTrace)"

**Description:** This is a general error message that occurs when an unexpected error is encountered during the loading process.

**Resolution:**

- Read the error message, source, and stack trace to pinpoint the issue.
- Check if it is a known issue and apply a suitable fix.
- If you are unable to resolve the issue, consider seeking help from community forums or the support team.

---

## Missing Version Header

**Error Message:** "DMI.Load: The Ztxt header does not contain a version header."

**Description:** This error occurs when the DMI file does not contain the necessary version header in the Ztxt chunk.

**Resolution:**

- Ensure that the DMI file adheres to the expected structure and format.
- Verify that the DMI file contains a version header within the Ztxt chunk.

---

## Incompatible DMI Version

**Error Message:** "DMI.Load: Incompatible DMI version (X.X), Please use a DMI with a 4.0 version."

**Description:** This error is raised when the DMI file version is not compatible with the expected version 4.0.

**Resolution:**

- Update or convert the DMI file to the compatible version (4.0).
- If you are using a third-party tool to generate the DMI file, check if it supports generating files in the compatible version.
- In the event that upgrading your DMI file to version 4.0 is not feasible, you could attempt to alter the "private string _targetVersion" variable at the beginning of the file by changing its value. However, be aware that this might cause the script to behave unpredictably, or unhandled issues may arise.

---

## Missing Width or Height Information

**Error Message:** "DMI.Load: DMI header does not contain width or height information."

**Description:** This error occurs if the DMI file header does not contain the necessary width or height information.

**Resolution:**

- Make sure that the DMI file is properly formatted and contains width and height information in its header.
- If the file is generated by a tool, verify if the tool properly supports creating well-formatted DMI files.

---

## PNG Header Mismatch

**Error Message:** "PngReader: PNG header does not match."



**Description:** This error occurs if the PNG header within the DMI file does not match the expected format.

**Resolution:**

- Make sure that the DMI file contains a valid PNG image.
- Ensure that the file is not corrupted.
- If the DMI file was generated using a tool, confirm that the tool is generating files correctly.

---

## Unknown Compression Method

**Error Message:** "zTXt chunk with unknown compression method."

**Description:** This error occurs when the zTXt chunk within the DMI file uses an unknown or unsupported compression method.

**Resolution:**

- Confirm that the compression method used in the zTXt chunk of the DMI file is supported.
- If possible, re-save or re-export the DMI file with a supported compression method.

---

## zTXt Chunk Not Found

**Error Message:** "Did not find a zTXt chunk."

**Description:** This error is raised when the DMI file does not contain a zTXt chunk, which is necessary for storing metadata.

**Resolution:**

- Ensure that the DMI file is not corrupted and that it includes a zTXt chunk.
- Verify that the DMI file adheres to the expected format and structure.

---